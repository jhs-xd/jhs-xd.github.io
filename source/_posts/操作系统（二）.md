---
title: 操作系统（二）
copyright: true
categories: 
  - 《计算机操作系统》
tags: 
  - OS

---
<blockquote class="blockquote-center">The man who has made up his mind to win will never say “impossible”.
![](/myimages/13.jpg)<blockquote>

进程管理

<!-- more -->

---

# 进程的基本概念 #

## 进程的特征 ##
1. 结构特征
通常的程序不能并发执行，为使程序能独立运行，应为之配置一进程控制块（PCB：Process Control Block）
进程实体：程序段+数据段+PCB
2. 动态性
进程的实质是进程实体的一次执行过程
3. 并发性
多个进程实体同存于内存中，且能在一段时间内同时运行
4. 独立性
传统OS中，进程实体是一个能独立运行、独立分配资源和独立接收调度的基本单位
5. 异步性
进程按各自独立、不可预知的速度向前推进

## 进程的状态 ##
一、三种基本状态
1. 就绪状态
2. 执行状态
3. 阻塞状态
导致阻塞的典型事件：请求IO，申请缓冲空间

二、挂起状态

	引起挂起状态的原因：
	-  终端用户的请求（进程处于就绪状态，且暂不接受调度）
	-  父进程请求
	-  符合调节的需要
	-  操作系统的需要

三、创建状态和终止状态
1. 创建状态
		创建进程的两个步骤：
		（1）为新进程创建PCB，并填写必要的管理信息
		（2）把该进程转入就绪状态并插入就绪队列之中
		注意：
		创建状态的进程还不能被调度，因为虽然进程有了PCB，但是还未进入主存
2. 终止状态
		进程终止也有两个步骤：
		（1）等待操作系统进行善后处理，将PCB清零，将PCB空间返还系统
		（2）终止的进程在操作系统中还保留着记录，一旦其他进程完成了对终止进程记录的信息提取，操作系统正式删除该进程

四、进程状态的转换
1. 进程的五种基本状态转换

![](/myimages/13进程五状态转换.png)

2. 具有挂起状态的进程状态转换
![](/myimages/13进程七状态转换.png)

## 进程控制块PCB ##
1. 什么是PCB
		为了描述和控制进程的运行，系统为每一个进程定义了一个数据结构——进程控制块，它是进程实体的一部分
2. PCB的作用
		使进程能够独立运行，并与其他进程并发执行
		PCB是进程存在的唯一标志
3. PCB中的信息
	- 进程标识符
		- 内部标识符：操作系统赋予的唯一的数字标识符，方便系统使用
		- 外部标识符：用户创建，通常由数字和字母组成，用户进程访问该进程时使用
	- 处理机状态：用于保存处理机中各种寄存器中的信息，以便在进程中断后重新执行时，能找到断点的信息
	- 进程调度信息
	- 进程控制信息
4. PCB的组织方式
	-  链接方式：把同一状态的PCB，用链接字链接成一个队列
	-  索引方式：根据进程的状态建立相应的索引表

---

# 进程控制 #
进程控制是进程管理中最基本的功能
进程控制一般由OS内核中的原语（原子操作，在管态下执行）来实现

## 进程的创建 ##
1. 引起创建进程的事件
	- 用户登录
	- 作业调度
	- 提供服务
	- 应用请求
2. 调用进程创建原语Creat()创建进程的步骤
	- 申请空白PCB
	- 为新进程分配资源
	- 初始化进程控制块
	- 将新进程插入就绪队列

## 进程的终止 ##
1. 引起进程终止的事件
	- 正常结束：产生一个中断，通知OS进程已运行完毕
	- 异常结束：出现错误和故障
	- 外界干预：进程应外界请求而终止
2. 进程的终止过程
OS调用进程终止原语终止进程：
	- 根据终止进程的标识符，找到该进程的PCB，读出该进程的状态
	- 终止该进程的执行
	- 终止子孙进程
	- 将被终止进程的资源归还给父进程
	- 将被终止进程从所在队列中移出

## 进程的阻塞与唤醒 ##
1. 进程阻塞
进程无法继续执行，于是进程便通过调用阻塞原语block把自己阻塞
进程阻塞是进程自身的一种主动行为
2. 进程唤醒

## 进程的挂起与激活 ##

---

# 进程同步 #
进程同步的任务：对并发执行的诸进程在执行次序上进行协调，使程序的执行具有可再现性

1. 同步机制——进程互斥地进入自己的临界区
		临界资源：进程间采用互斥方式对资源进行共享
		临界区：进程中访问临界资源的那段代码
		同步机制：进程互斥地进入自己的临界区
		同步机制四条原则：
			空闲让进
			忙则等待
			有限等待：保证进程在有限时间内能进入到自己的临界区
			让权等待：当进程不能进入自己的临界区，应立即释放处理机
2. 进程同步工具——信号量机制、管程
 （1）信号量机制
	- 整型信号量
	- 记录型信号量
	- AND型信号量
	- 信号量集

 （2）管程
	管程是操作系统的资源管理模块，被请求和释放资源的进程调用
3. 信号量的应用
	- 实现进程互斥
	- 实现前趋关系

---

# 进程通信 #
进程通信：进程之间的信息交换
低级通信：利用信号量机制实现进程间的数据传输（效率低、通信对用户不透明）
高级进程通信：利用操作系统提供的一组通信命令实现进程之间的高效通信
1. 高级通信机制
	- 共享存储器系统
	- 消息传递系统（应用最广，以格式化报文交换数据）
	- 管道通信系统（通过共享文件pipe连接读进程和写进程来实现进程间通信）
2. 消息传递通信的实现方法
	- 直接通信：发送进程通过OS提供的发送命令，直接把消息发送给目标进程
	- 间接通信：通过信箱实现通信，信箱可由OS或用户创建
		- 私有信箱
		- 公有信箱
		- 共享信箱

---

# 线程 #

## 线程的基本概念 ##
1. 线程：系统中独立运行和任务调度的基本单位。
2. 特点：比进程更小的能独立运行的基本单位，用来提高程序并发执行的程度，使OS具有更好的并发性
3. 线程与进程的区别
		（1）调度
		进程是资源分配的基本单位，执行和调度的基本单位是线程（进程不再作为一个可执行的实体）
		（2）并发性
		不仅进程可以并发执行，一个进程中的多个线程也能并发执行
		（3）拥有资源
		线程自己（几乎）不拥有系统资源，但可访问其隶书进程的资源
		（4）系统开销
		线程的创建、撤销和切换比进程的开销小得多
4. 线程的状态
线程和进程一样拥有就绪、执行、阻塞状态

## 线程间的同步 ##

线程同步机制
- 互斥锁
-  条件变量
-  信号量机制

## 线程的实现方式 ##
1. 内核支持线程（KST）
（1）无论是系统进程还是用户进程，进程的创建、撤销都是在系统内核的支持下完成的
（2）KST方式下，线程的创建、撤销和切换都是在系统内核的支持下完成的，在内核空间中通过线程控制块TCB对线程进行控制
（3）线程切换时需要从用户态转到系统态，系统开销较大
2. 用户级线程（ULT）
仅存在于用户空间中，线程的创建、撤销和切换无需系统内核的支持（因此线程切换速度快）